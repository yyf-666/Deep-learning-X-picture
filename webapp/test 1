import numpy as np
from keras.models import load_model
import gradio as gr
import numpy as np
from keras.models import load_model
from keras.preprocessing import image

MODEL_LOC = '../model/pneumonia_detection_cnn_model.h5'
DATA_DIR = '../data1/'
TRAINING_DATA_DIR = DATA_DIR + '/train/'
TEST_DATA_DIR = DATA_DIR + '/test/'
VAL_DATA_DIR = DATA_DIR + '/val/'
DETECTION_CLASSES = ('NORMAL', 'PNEUMONIA')
BATCH_SIZE = 32
EPOCHS = 100


cnn_model = load_model(MODEL_LOC)

__author__ = "Baishali Dutta"
__copyright__ = "Copyright (c) 2021-2022 Baishali Dutta"
__license__ = "Apache License 2.0"
__version__ = "0.1"



test_image = "NORMAL2.jpeg"
test_image = image.load_img(test_image, target_size=(224, 224))
test_image = image.img_to_array(test_image) / 255.
test_image = np.expand_dims(test_image, axis=0)
result = cnn_model.predict(test_image)
result = cnn_model.predict(test_image)


